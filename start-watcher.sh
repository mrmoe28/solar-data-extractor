#!/bin/bash

# Start Scraper Job Watcher
# This script starts the job watcher that monitors the dashboard for scraping jobs

clear

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘                                                                  â•‘"
echo "â•‘          ğŸ¤–  SCRAPER JOB WATCHER LAUNCHER  ğŸ¤–                    â•‘"
echo "â•‘                                                                  â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Check if we're in the right directory
if [ ! -f "package.json" ]; then
  echo "âŒ Error: package.json not found"
  echo "Please run this script from the solar-data-extractor directory"
  exit 1
fi

# Check if .env file exists
if [ ! -f ".env" ]; then
  echo "âš ï¸  Warning: .env file not found"
  echo ""
  echo "Running setup script to configure environment..."
  ./setup.sh
  echo ""
fi

# Check if node_modules exists
if [ ! -d "node_modules" ]; then
  echo "ğŸ“¦ Installing dependencies..."
  npm install
  echo ""
fi

echo "ğŸš€ Starting job watcher..."
echo ""
echo "âœ… Watcher is now running!"
echo "ğŸ’¡ Go to the dashboard and click 'Start Scraping'"
echo "ğŸŒ Dashboard: https://eko-lead-dashboard.vercel.app/scraping"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

# Start the job watcher
npm run watch
